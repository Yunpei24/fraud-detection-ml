# ==============================================================================
# Data Module - Environment Variables Configuration
# ==============================================================================
# Copy this file to .env and configure for your environment
# For Docker Compose: these variables are set in docker-compose.yml
# Updated to match Pydantic Settings migration (2025-10-22)

# ==============================================================================
# ENVIRONMENT
# ==============================================================================
ENV=development
DEBUG=false

# ==============================================================================
# DATABASE (PostgreSQL)
# ==============================================================================
DB_SERVER=localhost
DB_NAME=fraud_db
DB_USER=postgres
DB_PASSWORD=postgres
DB_PORT=5432
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40

# Legacy variables (for backward compatibility)
DB_HOST=postgres
POSTGRES_PASSWORD=fraud_password_dev

# For Docker Compose, use:
# DB_SERVER=fraud_db
# DATABASE_URL will be constructed automatically as:
# postgresql://DB_USER:DB_PASSWORD@DB_SERVER:DB_PORT/DB_NAME

# ==============================================================================
# CACHE (Redis)
# ==============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
CACHE_TTL_SECONDS=3600

# Legacy variable (for backward compatibility)
# REDIS_PASSWORD=redis_password_dev

# For Docker Compose, use:
# REDIS_HOST=redis

# ==============================================================================
# KAFKA (Message Queue)
# ==============================================================================
# Kafka bootstrap servers (comma-separated list)
KAFKA_BOOTSTRAP_SERVERS=kafka:9092
# Kafka topic for fraud transactions
KAFKA_TOPIC=fraud-detection-transactions
# Consumer group ID
KAFKA_CONSUMER_GROUP=fraud-detection-pipeline
# Auto offset reset strategy (earliest, latest, none)
KAFKA_AUTO_OFFSET_RESET=earliest
# Batch size for consuming messages
KAFKA_BATCH_SIZE=1000
# Timeout in milliseconds
KAFKA_TIMEOUT_MS=60000
# Max records per poll
KAFKA_MAX_POLL_RECORDS=500

# Legacy variables (for backward compatibility)
KAFKA_BROKERS=localhost:9092
KAFKA_GROUP_ID=fraud-detection-group

# For Docker Compose, use:
# KAFKA_BOOTSTRAP_SERVERS=kafka:9092

# For local development (host access):
# KAFKA_BOOTSTRAP_SERVERS=localhost:29092

# ==============================================================================
# API ENDPOINTS
# ==============================================================================
# Fraud Detection API URL
API_URL=http://api:8000
# API request timeout (seconds)
API_TIMEOUT_SECONDS=60

# JWT Authentication for API
# Option 1: Username/Password (recommended for production)
API_USERNAME=pipeline-user
API_PASSWORD=your_secure_password

# Option 2: Pre-existing JWT token (for testing)
# API_TOKEN=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Web Application URL (for sending fraud alerts)
WEBAPP_URL=
# Web App request timeout (seconds)
WEBAPP_TIMEOUT_SECONDS=30

# For Docker Compose:
# API_URL=http://fraud-api:8000
# WEBAPP_URL=http://fraud-webapp:3000
# API_USERNAME=pipeline-user
# API_PASSWORD=${PIPELINE_API_PASSWORD}

# ==============================================================================
# AZURE (Cloud Services - Optional for Local Development)
# ==============================================================================
# Azure Storage
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=devaccount;AccountKey=devkey;EndpointSuffix=core.windows.net
AZURE_STORAGE_ACCOUNT=frauddetectiondl
AZURE_STORAGE_KEY=devkey
AZURE_DATA_LAKE_PATH=/data/transactions

# Azure Event Hub (if using instead of Kafka)
EVENT_HUB_NAME=fraud-transactions
EVENT_HUB_CONNECTION_STRING=

# ==============================================================================
# MONITORING
# ==============================================================================
PROMETHEUS_PORT=9092
LOG_LEVEL=INFO
ENABLE_PROFILING=false
ENABLE_DATA_VALIDATION=true

# ==============================================================================
# PYTHON ENVIRONMENT
# ==============================================================================
PYTHONUNBUFFERED=1
PYTHONDONTWRITEBYTECODE=1

# ==============================================================================
# USAGE WITH DOCKER COMPOSE
# ==============================================================================
# Example docker-compose.yml service configuration:
#
# data:
#   build: ./data
#   environment:
#     - DB_SERVER=fraud_db
#     - DB_NAME=fraud_detection
#     - DB_USER=postgres
#     - DB_PASSWORD=postgres
#     - REDIS_HOST=redis
#     - KAFKA_BROKERS=kafka:9093
#     - ENV=development
#   depends_on:
#     - fraud_db
#     - redis
#   ports:
#     - "9092:9092"  # Prometheus metrics

# ==============================================================================
# NESTED ENVIRONMENT VARIABLES (Pydantic Feature)
# ==============================================================================
# You can also use nested notation with double underscores:
# KAFKA__TOPIC=fraud-transactions
# KAFKA__GROUP_ID=fraud-detection-group
# DATABASE__SERVER=localhost
# DATABASE__PORT=5432

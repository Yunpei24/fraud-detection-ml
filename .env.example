# ==============================================================================
# FRAUD DETECTION MLOPS PROJECT - CENTRALIZED ENVIRONMENT VARIABLES
# ==============================================================================
# This file contains ALL environment variables for the entire project.
# Copy this to .env and configure for your environment.
#
# For Docker Compose: variables are set in docker-compose.yml
# For Production: use Kubernetes secrets or Azure Key Vault
# ==============================================================================

# ==============================================================================
# ENVIRONMENT
# ==============================================================================
ENVIRONMENT=development
DEBUG=false

# ==============================================================================
# DATABASE (PostgreSQL - Shared across all modules)
# ==============================================================================
DB_HOST=localhost
DB_PORT=5432
DB_NAME=fraud_db
DB_USER=postgres
DB_PASSWORD=postgres
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_SSL_MODE=prefer

# Legacy variables (for backward compatibility during migration)
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/fraud_db
POSTGRES_PASSWORD=postgres

# ==============================================================================
# CACHE (Redis - Shared across all modules)
# ==============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_SSL=false
REDIS_TTL_SECONDS=3600

# ==============================================================================
# AZURE (Cloud Services - Optional for Local Development)
# ==============================================================================
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=frauddetectionstorage;AccountKey=your_key;EndpointSuffix=core.windows.net
AZURE_STORAGE_ACCOUNT_NAME=frauddetection
AZURE_STORAGE_ACCOUNT_KEY=your_key
AZURE_CONTAINER_MODELS=models
AZURE_CONTAINER_REPORTS=reports
AZURE_CONTAINER_DATA=data
AZURE_KEY_VAULT_URL=https://fraud-detection-kv.vault.azure.net/

# Azure Event Hub (alternative to Kafka)
AZURE_EVENT_HUB_CONNECTION_STRING=
AZURE_EVENT_HUB_NAME=fraud-transactions

# ==============================================================================
# KAFKA (Message Queue - Alternative to Event Hub)
# ==============================================================================
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_TOPIC_TRANSACTIONS=fraud-detection-transactions
KAFKA_CONSUMER_GROUP=fraud-detection-pipeline
KAFKA_AUTO_OFFSET_RESET=earliest
KAFKA_BATCH_SIZE=1000
KAFKA_TIMEOUT_MS=60000

# Legacy variables (for backward compatibility)
KAFKA_BROKERS=localhost:9092
KAFKA_TOPIC=fraud-transactions
KAFKA_GROUP_ID=fraud-detection-group

# ==============================================================================
# MONITORING & LOGGING (Shared)
# ==============================================================================
MONITORING_PROMETHEUS_ENABLED=true
MONITORING_LOG_LEVEL=INFO
MONITORING_LOG_FORMAT=json
MONITORING_ENABLE_AUDIT_LOG=true

# ==============================================================================
# SECURITY (Shared)
# ==============================================================================
SECURITY_SECRET_KEY=your-super-secret-key-change-in-production
SECURITY_ALGORITHM=HS256
SECURITY_ACCESS_TOKEN_EXPIRE_MINUTES=30
SECURITY_API_KEY_HEADER=X-API-Key

# ==============================================================================
# ALERTING (Shared)
# ==============================================================================
ALERT_EMAIL_ENABLED=true
ALERT_EMAIL_SMTP_HOST=smtp.gmail.com
ALERT_EMAIL_SMTP_PORT=587
ALERT_EMAIL_USERNAME=your-email@example.com
ALERT_EMAIL_PASSWORD=your-app-password
ALERT_EMAIL_FROM=fraud-detection@example.com
ALERT_EMAIL_RECIPIENTS=ml-team@example.com,ops-team@example.com

ALERT_SLACK_ENABLED=false
ALERT_SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
ALERT_SLACK_CHANNEL=#fraud-alerts

ALERT_MAX_ALERTS_PER_HOUR=5
ALERT_DEBOUNCE_MINUTES=30

# ==============================================================================
# MLFLOW (Shared)
# ==============================================================================
MLFLOW_TRACKING_URI=http://localhost:5000
MLFLOW_EXPERIMENT_NAME=fraud-detection
MLFLOW_MODEL_NAME=fraud-detection-ensemble

# ==============================================================================
# API MODULE CONFIGURATION
# ==============================================================================
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_RELOAD=false
API_VERSION=1.0.0
API_TITLE=Fraud Detection API
API_DESCRIPTION=Real-time fraud detection API with ensemble models

API_FRAUD_THRESHOLD=0.5
API_CONFIDENCE_THRESHOLD=0.7

API_RATE_LIMIT_ENABLED=true
API_RATE_LIMIT_REQUESTS=100
API_RATE_LIMIT_PERIOD=60

API_CORS_ORIGINS=http://localhost:3000,http://localhost:8080
API_CORS_ALLOW_CREDENTIALS=true
API_CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
API_CORS_ALLOW_HEADERS=*

API_ENABLE_BATCH_PREDICTION=true
API_ENABLE_SHAP_EXPLANATION=true
API_ENABLE_MODEL_RELOAD=true
API_ENABLE_CACHE=true

MODEL_PATH=/app/models
API_MODEL_VERSION=v1.0.0
API_PROMETHEUS_PORT=9090

# ==============================================================================
# DATA MODULE CONFIGURATION
# ==============================================================================
DATA_API_URL=http://api:8000
DATA_API_TIMEOUT_SECONDS=60
DATA_WEBAPP_URL=
DATA_WEBAPP_TIMEOUT_SECONDS=30
DATA_PROMETHEUS_PORT=9092
DATA_ENABLE_PROFILING=false
DATA_ENABLE_DATA_VALIDATION=true

# ==============================================================================
# DRIFT MODULE CONFIGURATION
# ==============================================================================
DRIFT_DATA_DRIFT_THRESHOLD=0.3
DRIFT_TARGET_DRIFT_THRESHOLD=0.5
DRIFT_CONCEPT_DRIFT_THRESHOLD=0.05

DRIFT_BASELINE_RECALL=0.98
DRIFT_BASELINE_PRECISION=0.95
DRIFT_BASELINE_FPR=0.015
DRIFT_BASELINE_FRAUD_RATE=0.002

DRIFT_HOURLY_WINDOW_SIZE=3600
DRIFT_DAILY_WINDOW_SIZE=86400
DRIFT_WEEKLY_WINDOW_SIZE=604800

DRIFT_MIN_SAMPLES_FOR_DRIFT=1000
DRIFT_RETRAINING_COOLDOWN_HOURS=48
DRIFT_CONSECUTIVE_DRIFT_DETECTIONS=3

DRIFT_REPORT_ENABLED=true
DRIFT_REPORT_RETENTION_DAYS=90
DRIFT_REPORT_FORMAT=html

DRIFT_PROMETHEUS_PORT=9091

# ==============================================================================
# TRAINING MODULE CONFIGURATION
# ==============================================================================
TRAINING_TRAIN_DATA_PATH=/data/train.csv
TRAINING_TEST_DATA_PATH=/data/test.csv
TRAINING_MODEL_OUTPUT_DIR=/models
TRAINING_CHECKPOINT_DIR=/checkpoints

TRAINING_BATCH_SIZE=1024
TRAINING_EPOCHS=10
TRAINING_VALIDATION_SPLIT=0.2
TRAINING_EARLY_STOPPING_PATIENCE=5

TRAINING_CV_FOLDS=5
TRAINING_CV_STRATEGY=stratified

TRAINING_ENABLE_FEATURE_SELECTION=true
TRAINING_FEATURE_IMPORTANCE_THRESHOLD=0.01
TRAINING_ENABLE_SCALING=true
TRAINING_SCALER_TYPE=standard

TRAINING_EVAL_METRICS=precision,recall,f1,auc,accuracy
TRAINING_EVAL_THRESHOLD=0.5

TRAINING_PROMETHEUS_PORT=9093

# ==============================================================================
# AIRFLOW MODULE CONFIGURATION
# ==============================================================================
AIRFLOW_HOME=/opt/airflow
AIRFLOW_DATABASE_URL=postgresql://airflow:airflow@postgres:5432/airflow_db
AIRFLOW_EXECUTOR=LocalExecutor
AIRFLOW_PARALLELISM=32
AIRFLOW_MAX_ACTIVE_RUNS_PER_DAG=3

AIRFLOW_API_BASE_URL=http://fraud-api:8000
AIRFLOW_DATA_BASE_URL=http://fraud-data:8001
AIRFLOW_DRIFT_BASE_URL=http://fraud-drift:8002

AIRFLOW_MIN_TRAINING_SAMPLES=10000
AIRFLOW_TRAINING_COOLDOWN_HOURS=48

AIRFLOW_DATABRICKS_HOST=https://your-databricks-workspace.cloud.databricks.com
AIRFLOW_DATABRICKS_TOKEN=your-databricks-token
AIRFLOW_DATABRICKS_TRAINING_JOB_ID=12345

DOCKERHUB_USERNAME=yoshua24

AIRFLOW_TRAINING_DAG_ID=02_model_training

# ==============================================================================
# DOCKER COMPOSE ENVIRONMENT CONFIGURATION
# ==============================================================================
# Example docker-compose.yml service configuration:
#
# api:
#   environment:
#     - ENVIRONMENT=development
#     - DB_HOST=fraud_db
#     - REDIS_HOST=redis
#     - API_PORT=8000
#   depends_on:
#     - fraud_db
#     - redis
#
# data:
#   environment:
#     - ENVIRONMENT=development
#     - DB_HOST=fraud_db
#     - REDIS_HOST=redis
#     - KAFKA_BOOTSTRAP_SERVERS=kafka:9092
#   depends_on:
#     - fraud_db
#     - redis
#     - kafka
#
# drift:
#   environment:
#     - ENVIRONMENT=development
#     - DB_HOST=fraud_db
#   depends_on:
#     - fraud_db
#
# training:
#   environment:
#     - ENVIRONMENT=development
#     - DB_HOST=fraud_db
#     - REDIS_HOST=redis
#   depends_on:
#     - fraud_db
#     - redis
#
# airflow:
#   environment:
#     - ENVIRONMENT=development
#     - DB_HOST=fraud_db
#     - AIRFLOW_DATABASE_URL=postgresql://airflow:airflow@postgres-airflow:5432/airflow_db
#   depends_on:
#     - fraud_db
#     - postgres-airflow

# ==============================================================================
# PRODUCTION ENVIRONMENT NOTES
# ==============================================================================
# For production deployments:
# 1. Use Kubernetes secrets for sensitive values
# 2. Use Azure Key Vault for secrets management
# 3. Set ENVIRONMENT=production
# 4. Configure proper database credentials
# 5. Set up monitoring and alerting
# 6. Configure Azure storage for model artifacts
# 7. Set up MLflow tracking server
# 8. Configure proper CORS origins for your frontend
